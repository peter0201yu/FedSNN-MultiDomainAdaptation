Global model initialized using pretrained model
Round 1 --------------------------------
Domain: mnist_m, user idx: 0
Selected 2299 samples from 11000 imgs
Selected 2710 samples from 11000 imgs
Domain: mnist_m, user idx: 1
Selected 2330 samples from 11000 imgs
Selected 2731 samples from 11000 imgs
Domain: mnist_m, user idx: 2
Selected 2294 samples from 11000 imgs
Selected 2802 samples from 11000 imgs
Domain: mnist_m, user idx: 3
Selected 2301 samples from 11000 imgs
Selected 2700 samples from 11000 imgs
Domain: mnist_m, user idx: 4
Selected 2318 samples from 11000 imgs
Selected 2618 samples from 11000 imgs
Round   1, Average loss 1.622
Domain: syn, user idx: 0
Selected 880 samples from 5000 imgs
Selected 755 samples from 5000 imgs
Domain: syn, user idx: 1
Selected 872 samples from 5000 imgs
Selected 718 samples from 5000 imgs
Domain: syn, user idx: 2
Selected 875 samples from 5000 imgs
Selected 635 samples from 5000 imgs
Domain: syn, user idx: 3
Selected 877 samples from 5000 imgs
Selected 655 samples from 5000 imgs
Domain: syn, user idx: 4
Selected 916 samples from 5000 imgs
Selected 674 samples from 5000 imgs
Round   1, Average loss 1.701
Domain: svhn, user idx: 0
Selected 1035 samples from 14651 imgs
Selected 406 samples from 14651 imgs
Domain: svhn, user idx: 1
Selected 1043 samples from 14651 imgs
Selected 222 samples from 14651 imgs
Domain: svhn, user idx: 2
Selected 1076 samples from 14651 imgs
Selected 337 samples from 14651 imgs
Domain: svhn, user idx: 3
Selected 1083 samples from 14651 imgs
Selected 343 samples from 14651 imgs
Domain: svhn, user idx: 4
Selected 1037 samples from 14651 imgs
Selected 259 samples from 14651 imgs
Round   1, Average loss 1.787
Domain: usps, user idx: 0
Selected 971 samples from 1487 imgs
Selected 1131 samples from 1487 imgs
Domain: usps, user idx: 1
Selected 981 samples from 1487 imgs
Selected 1149 samples from 1487 imgs
Domain: usps, user idx: 2
Selected 971 samples from 1487 imgs
Selected 1136 samples from 1487 imgs
Domain: usps, user idx: 3
Selected 965 samples from 1487 imgs
Selected 1153 samples from 1487 imgs
Domain: usps, user idx: 4
Selected 920 samples from 1487 imgs
Selected 1125 samples from 1487 imgs
Round   1, Average loss 1.711
Round 1, Domain: mnist_m, Testing accuracy: 46.70
Round 1, Domain: syn, Testing accuracy: 40.33
Round 1, Domain: svhn, Testing accuracy: 28.02
Round 1, Domain: usps, Testing accuracy: 89.62
Round 2 --------------------------------
Domain: mnist_m, user idx: 0
Selected 2596 samples from 11000 imgs
Selected 2955 samples from 11000 imgs
Domain: mnist_m, user idx: 1
Selected 2677 samples from 11000 imgs
Selected 2956 samples from 11000 imgs
Domain: mnist_m, user idx: 2
Selected 2633 samples from 11000 imgs
Selected 2895 samples from 11000 imgs
Domain: mnist_m, user idx: 3
Selected 2692 samples from 11000 imgs
Selected 3051 samples from 11000 imgs
Domain: mnist_m, user idx: 4
Selected 2623 samples from 11000 imgs
Selected 2874 samples from 11000 imgs
Round   2, Average loss 1.544
Domain: syn, user idx: 0
Selected 955 samples from 5000 imgs
Selected 880 samples from 5000 imgs
Domain: syn, user idx: 1
Selected 953 samples from 5000 imgs
Selected 898 samples from 5000 imgs
Domain: syn, user idx: 2
Selected 929 samples from 5000 imgs
Selected 848 samples from 5000 imgs
Domain: syn, user idx: 3
Selected 940 samples from 5000 imgs
Selected 872 samples from 5000 imgs
Domain: syn, user idx: 4
Selected 921 samples from 5000 imgs
Selected 852 samples from 5000 imgs
Round   2, Average loss 1.612
Domain: svhn, user idx: 0
Traceback (most recent call last):
  File "fed_mda_simplified.py", line 97, in <module>
    w, loss = local.mda_train(net=model_copy.to(args.device))
  File "/gpfs/loomis/scratch60/panda/zy264/FedMDA/MDA/models/Update.py", line 84, in mda_train
    for idx, (imgs, labels) in enumerate(forward_dl):
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 530, in __next__
    data = self._next_data()
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 570, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gpfs/loomis/scratch60/panda/zy264/FedMDA/MDA/models/Update.py", line 25, in __getitem__
    image, label = self.dataset[self.idxs[item]]
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 230, in __getitem__
    sample = self.loader(path)
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 269, in default_loader
    return pil_loader(path)
  File "/gpfs/loomis/project/panda/zy264/conda_envs/py38/lib/python3.8/site-packages/torchvision/datasets/folder.py", line 247, in pil_loader
    with open(path, "rb") as f:
KeyboardInterrupt